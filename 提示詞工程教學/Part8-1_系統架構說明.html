<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>8-1 系統架構說明 - LINE AI 評語機器人</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft JhengHei', 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #0c1445 0%, #1a237e 50%, #283593 100%);
            min-height: 100vh;
            overflow: hidden;
            color: #333;
        }
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-image:
                radial-gradient(2px 2px at 20px 30px, white, transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
                radial-gradient(1px 1px at 90px 40px, white, transparent),
                radial-gradient(2px 2px at 160px 120px, rgba(255,255,255,0.9), transparent);
            background-size: 550px 250px;
            animation: twinkle 8s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }
        @keyframes twinkle {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 0.4; }
        }

        .nav-bar {
            position: fixed;
            top: 0; left: 0; right: 0;
            height: 60px;
            background: rgba(26, 35, 126, 0.95);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.15);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            z-index: 10000;
        }
        .nav-title {
            font-size: 20px;
            font-weight: 700;
            background: linear-gradient(90deg, #00c300, #00e676);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .nav-buttons { display: flex; gap: 12px; }
        .nav-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 18px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        .nav-btn:hover {
            background: rgba(0, 195, 0, 0.3);
            border-color: #00c300;
        }

        .nav-arrow {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(26, 35, 126, 0.8);
            color: white;
            width: 60px; height: 60px;
            border-radius: 50%;
            border: 2px solid rgba(0, 195, 0, 0.5);
            font-size: 24px;
            cursor: pointer;
            z-index: 9000;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .nav-arrow:hover {
            background: rgba(57, 73, 171, 0.9);
            transform: translateY(-50%) scale(1.1);
        }
        .prev-arrow { left: 30px; }
        .next-arrow { right: 30px; }
        .nav-arrow:disabled { opacity: 0.3; cursor: not-allowed; }

        .slide-container {
            width: 100%;
            height: 100vh;
            padding-top: 60px;
            position: relative;
            z-index: 1;
        }
        .slide {
            position: absolute;
            top: 60px; left: 0;
            width: 100%;
            height: calc(100vh - 60px);
            display: none;
            align-items: center;
            justify-content: center;
            padding: 40px;
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: 10;
        }
        .slide.active {
            display: flex;
            opacity: 1;
            z-index: 20;
        }

        .content-card {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            padding: 40px 50px;
            max-width: 1350px;
            width: 95%;
            max-height: 85vh;
            overflow-y: auto;
            position: relative;
        }

        h1 {
            font-size: 42px;
            margin-bottom: 20px;
            text-align: center;
            background: linear-gradient(135deg, #00c300, #00e676);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        h2 {
            color: #00c300;
            font-size: 30px;
            margin-bottom: 25px;
            border-bottom: 4px solid;
            border-image: linear-gradient(90deg, #00c300, #00e676) 1;
            padding-bottom: 12px;
        }
        h3 { color: #00a000; font-size: 22px; margin: 20px 0 12px 0; }
        h4 { color: #00c300; font-size: 18px; margin: 15px 0 8px 0; }

        p, li {
            font-size: 17px;
            line-height: 1.8;
            color: #444;
            margin-bottom: 10px;
        }
        ul, ol { margin-left: 25px; margin-bottom: 15px; }

        .highlight-box {
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            border-left: 5px solid #00c300;
            padding: 20px 25px;
            border-radius: 0 15px 15px 0;
            margin: 20px 0;
        }
        .highlight-box h4 {
            color: #00c300;
            margin-top: 0;
        }

        .example-box {
            background: linear-gradient(135deg, #fff3e0, #ffe0b2);
            border-left: 5px solid #ff6f00;
            padding: 20px 25px;
            border-radius: 0 15px 15px 0;
            margin: 20px 0;
        }
        .example-box h4 { color: #e65100; margin-top: 0; }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin: 20px 0;
        }
        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 20px 0;
        }
        .grid-5 {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .card {
            background: #f5f5f5;
            border-radius: 15px;
            padding: 20px;
            border-top: 4px solid #00c300;
        }
        .card.orange { border-top-color: #ff6f00; }
        .card.blue { border-top-color: #0277bd; }
        .card h4 { margin-top: 0; }

        .flow-box {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid #1976d2;
        }
        .flow-box.line {
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            border-color: #00c300;
        }
        .flow-box.gas {
            background: linear-gradient(135deg, #fff3e0, #ffe0b2);
            border-color: #ff6f00;
        }
        .flow-box.sheet {
            background: linear-gradient(135deg, #e8f5e9, #a5d6a7);
            border-color: #4caf50;
        }
        .flow-box.ai {
            background: linear-gradient(135deg, #e1f5fe, #b3e5fc);
            border-color: #0288d1;
        }
        .flow-box .icon {
            font-size: 36px;
            margin-bottom: 10px;
        }
        .flow-box .label {
            font-size: 16px;
            font-weight: 700;
        }
        .flow-box .desc {
            font-size: 13px;
            color: #666;
            margin-top: 5px;
        }

        .flow-arrow {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: #1976d2;
        }

        .code-box {
            background: linear-gradient(135deg, #1a237e, #283593);
            color: #e8eaf6;
            padding: 20px;
            border-radius: 12px;
            font-family: 'Consolas', monospace;
            font-size: 14px;
            line-height: 1.6;
            margin: 15px 0;
            overflow-x: auto;
        }
        .code-box .comment { color: #81c784; }
        .code-box .keyword { color: #64b5f6; }
        .code-box .string { color: #ffb74d; }
        .code-box .function { color: #ce93d8; }

        .tag {
            display: inline-block;
            background: #00c300;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
            margin-right: 8px;
            margin-bottom: 8px;
        }
        .tag.orange { background: #ff6f00; }
        .tag.blue { background: #0277bd; }

        .progress-indicator {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            z-index: 9999;
        }
        .progress-dot {
            width: 12px; height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s;
        }
        .progress-dot.active {
            background: #00c300;
            transform: scale(1.3);
        }

        @media (max-width: 900px) {
            .grid-2, .grid-3, .grid-5 { grid-template-columns: 1fr; }
            .content-card { padding: 25px; }
            h1 { font-size: 32px; }
            h2 { font-size: 24px; }
        }
    </style>
</head>
<body>
    <nav class="nav-bar">
        <div class="nav-title">8-1 系統架構說明</div>
        <div class="nav-buttons">
            <a href="index2.html" class="nav-btn">首頁</a>
            <a href="Part8-2_LINE_Bot建立.html" class="nav-btn">下一章</a>
            <button class="nav-btn" onclick="toggleFullscreen()">全螢幕</button>
            <a href="https://www.youtube.com/@Liang-yt02" target="_blank" class="nav-btn">YT</a>
            <a href="https://www.facebook.com/?locale=zh_TW" target="_blank" class="nav-btn">FB</a>
            <a href="https://www.facebook.com/groups/2754139931432955?locale=zh_TW" target="_blank" class="nav-btn">3A</a>
        </div>
    </nav>

    <button class="nav-arrow prev-arrow" onclick="prevSlide()">←</button>
    <button class="nav-arrow next-arrow" onclick="nextSlide()">→</button>

    <div class="slide-container">
        <!-- Slide 1: 標題頁 -->
        <div class="slide active">
            <div class="content-card" style="text-align: center;">
                <div style="margin-bottom: 30px;">
                    <span class="tag">Part 8-1</span>
                    <span class="tag orange">核心實作</span>
                </div>
                <h1>LINE AI 評語機器人<br>系統架構說明</h1>
                <p style="font-size: 22px; color: #00c300; margin: 30px 0;">
                    LINE → GAS → Google Sheet → AI API → LINE
                </p>
                <div style="margin-top: 40px; padding: 25px; background: linear-gradient(135deg, #e8f5e9, #c8e6c9); border-radius: 15px;">
                    <p style="font-size: 18px; margin: 0;">
                        建立一個完整的自動化評語系統<br>
                        學生傳送作品，AI 自動分析並回覆個人化評語
                    </p>
                </div>
            </div>
        </div>

        <!-- Slide 2: 系統流程圖 -->
        <div class="slide">
            <div class="content-card">
                <h2>系統完整流程</h2>
                <p>從學生傳送作品到收到 AI 評語的完整資料流：</p>

                <div class="grid-5" style="margin: 30px 0; align-items: center;">
                    <div class="flow-box line">
                        <div class="icon">LINE</div>
                        <div class="label">學生傳送</div>
                        <div class="desc">簡報 / 文字 / 圖片</div>
                    </div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-box gas">
                        <div class="icon">GAS</div>
                        <div class="label">Webhook 處理</div>
                        <div class="desc">接收 & 解析訊息</div>
                    </div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-box sheet">
                        <div class="icon">Sheet</div>
                        <div class="label">記錄資料</div>
                        <div class="desc">儲存學生作品</div>
                    </div>
                </div>

                <div class="grid-5" style="margin: 30px 0; align-items: center;">
                    <div class="flow-box sheet">
                        <div class="icon">Sheet</div>
                        <div class="label">讀取內容</div>
                        <div class="desc">取得作品內容</div>
                    </div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-box ai">
                        <div class="icon">AI</div>
                        <div class="label">AI 分析</div>
                        <div class="desc">GPT-4o / Gemini</div>
                    </div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-box line">
                        <div class="icon">LINE</div>
                        <div class="label">回覆評語</div>
                        <div class="desc">個人化回饋</div>
                    </div>
                </div>

                <div class="highlight-box">
                    <h4>系統特色</h4>
                    <ul style="margin-bottom: 0;">
                        <li><strong>零成本部署</strong>：使用 Google Apps Script，完全免費</li>
                        <li><strong>即時回應</strong>：學生傳送後數秒內即可收到回覆</li>
                        <li><strong>資料保存</strong>：所有作品與評語都記錄在 Google Sheet</li>
                        <li><strong>彈性 AI</strong>：可選擇 OpenAI 或 Gemini API</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 3: 各元件說明 -->
        <div class="slide">
            <div class="content-card">
                <h2>系統元件說明</h2>

                <div class="grid-2">
                    <div class="card">
                        <h4 style="color: #00c300;">LINE Messaging API</h4>
                        <p>LINE 官方提供的開發者工具，讓我們可以：</p>
                        <ul>
                            <li>建立 LINE 官方帳號（Bot）</li>
                            <li>接收使用者傳送的訊息</li>
                            <li>主動推送訊息給使用者</li>
                            <li>處理圖片、檔案等多媒體內容</li>
                        </ul>
                        <p><strong>費用：</strong>免費方案每月 500 則推播</p>
                    </div>
                    <div class="card orange">
                        <h4 style="color: #ff6f00;">Google Apps Script (GAS)</h4>
                        <p>Google 提供的雲端腳本平台：</p>
                        <ul>
                            <li>可作為 Webhook 伺服器</li>
                            <li>直接操作 Google Sheet</li>
                            <li>呼叫外部 API（OpenAI、Gemini）</li>
                            <li>24/7 運行，免費無需付費</li>
                        </ul>
                        <p><strong>費用：</strong>完全免費（有執行時間限制）</p>
                    </div>
                    <div class="card" style="border-top-color: #4caf50;">
                        <h4 style="color: #4caf50;">Google Sheet</h4>
                        <p>作為資料庫使用：</p>
                        <ul>
                            <li>儲存學生資訊（LINE ID、姓名）</li>
                            <li>記錄作品內容（文字、檔案連結）</li>
                            <li>保存 AI 評語歷史</li>
                            <li>方便教師查看與匯出</li>
                        </ul>
                        <p><strong>費用：</strong>完全免費</p>
                    </div>
                    <div class="card blue">
                        <h4 style="color: #0277bd;">AI API（二選一）</h4>
                        <p>用於生成個人化評語：</p>
                        <ul>
                            <li><strong>OpenAI GPT-4o</strong>：品質穩定，按用量計費</li>
                            <li><strong>Google Gemini</strong>：免費額度高，回應快</li>
                        </ul>
                        <p><strong>費用：</strong></p>
                        <p>• OpenAI：約 $0.01/1000 tokens</p>
                        <p>• Gemini：每分鐘 15 次免費</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 4: 資料流詳解 -->
        <div class="slide">
            <div class="content-card">
                <h2>資料流詳解</h2>

                <div class="example-box">
                    <h4>Step 1：學生傳送作品</h4>
                    <p>學生透過 LINE 傳送訊息給機器人：</p>
                    <ul style="margin-bottom: 0;">
                        <li>純文字：直接傳送作品內容或心得</li>
                        <li>圖片：作品截圖或手寫內容</li>
                        <li>PDF 檔案：簡報或報告檔案</li>
                    </ul>
                </div>

                <div class="highlight-box">
                    <h4>Step 2：LINE 觸發 Webhook</h4>
                    <p>LINE 伺服器收到訊息後，會自動發送 POST 請求到我們設定的 Webhook URL（GAS 網址）</p>
                    <div class="code-box">
<span class="comment">// LINE 傳送的 Webhook 資料結構</span>
{
  <span class="string">"events"</span>: [{
    <span class="string">"type"</span>: <span class="string">"message"</span>,
    <span class="string">"replyToken"</span>: <span class="string">"xxx..."</span>,
    <span class="string">"source"</span>: { <span class="string">"userId"</span>: <span class="string">"U1234..."</span> },
    <span class="string">"message"</span>: {
      <span class="string">"type"</span>: <span class="string">"text"</span>,
      <span class="string">"text"</span>: <span class="string">"這是我的學習心得..."</span>
    }
  }]
}</div>
                </div>

                <div class="grid-2">
                    <div class="card">
                        <h4>Step 3：GAS 處理訊息</h4>
                        <ol>
                            <li>解析 LINE 傳來的 JSON 資料</li>
                            <li>取得使用者 ID 與訊息內容</li>
                            <li>若為檔案，下載並提取文字</li>
                            <li>將資料寫入 Google Sheet</li>
                        </ol>
                    </div>
                    <div class="card orange">
                        <h4>Step 4：呼叫 AI 生成評語</h4>
                        <ol>
                            <li>從 Sheet 讀取作品內容</li>
                            <li>組合提示詞 + 作品內容</li>
                            <li>呼叫 AI API 生成評語</li>
                            <li>將評語回傳給 LINE 使用者</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 5: Google Sheet 結構 -->
        <div class="slide">
            <div class="content-card">
                <h2>Google Sheet 資料結構設計</h2>
                <p>建議的試算表欄位配置：</p>

                <div style="overflow-x: auto; margin: 25px 0;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 15px;">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #00c300, #00e676); color: white;">
                                <th style="padding: 12px; border: 1px solid #ddd;">A. 時間戳記</th>
                                <th style="padding: 12px; border: 1px solid #ddd;">B. LINE ID</th>
                                <th style="padding: 12px; border: 1px solid #ddd;">C. 學生姓名</th>
                                <th style="padding: 12px; border: 1px solid #ddd;">D. 作品類型</th>
                                <th style="padding: 12px; border: 1px solid #ddd;">E. 作品內容</th>
                                <th style="padding: 12px; border: 1px solid #ddd;">F. AI 評語</th>
                                <th style="padding: 12px; border: 1px solid #ddd;">G. 四字評語</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 12px; border: 1px solid #ddd;">2026/01/26 10:30</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">U1234abc...</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">王小明</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">文字</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">我對火星探測...</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">你的報告展現...</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">探索未知・勇於嘗試</td>
                            </tr>
                            <tr style="background: #f5f5f5;">
                                <td style="padding: 12px; border: 1px solid #ddd;">2026/01/26 10:45</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">U5678def...</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">李小華</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">PDF</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">[檔案連結]</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">你的簡報結構...</td>
                                <td style="padding: 12px; border: 1px solid #ddd;">條理分明・邏輯清晰</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="highlight-box">
                    <h4>設計考量</h4>
                    <ul style="margin-bottom: 0;">
                        <li><strong>LINE ID</strong>：用於識別學生身份，可透過綁定功能對應到學生姓名</li>
                        <li><strong>作品類型</strong>：區分文字、圖片、PDF，方便後續分析</li>
                        <li><strong>AI 評語</strong>：保存完整評語，方便教師檢視與調整</li>
                        <li><strong>四字評語</strong>：獨立欄位，方便匯出製作結業證書</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 6: AI API 選擇 -->
        <div class="slide">
            <div class="content-card">
                <h2>AI API 選擇指南</h2>
                <p>兩種方案各有優缺點，根據您的需求選擇：</p>

                <div class="grid-2" style="margin-top: 25px;">
                    <div class="card" style="border-top-color: #0277bd;">
                        <h4 style="color: #0277bd;">OpenAI GPT-4o</h4>
                        <div style="background: #e3f2fd; padding: 15px; border-radius: 10px; margin: 15px 0;">
                            <p style="margin: 0; font-size: 24px; color: #0277bd;"><strong>推薦程度：★★★★☆</strong></p>
                        </div>
                        <h4>優點</h4>
                        <ul>
                            <li>評語品質穩定，語句通順</li>
                            <li>支援多語言，中文表現佳</li>
                            <li>API 文件完整，社群資源多</li>
                            <li>可處理圖片（Vision API）</li>
                        </ul>
                        <h4>缺點</h4>
                        <ul>
                            <li>需要付費（約 $0.01/1000 tokens）</li>
                            <li>需要綁定信用卡</li>
                        </ul>
                        <h4>適合對象</h4>
                        <p>追求品質、有預算、學生人數較多</p>
                    </div>
                    <div class="card" style="border-top-color: #00c300;">
                        <h4 style="color: #00c300;">Google Gemini</h4>
                        <div style="background: #e8f5e9; padding: 15px; border-radius: 10px; margin: 15px 0;">
                            <p style="margin: 0; font-size: 24px; color: #00c300;"><strong>推薦程度：★★★★★</strong></p>
                        </div>
                        <h4>優點</h4>
                        <ul>
                            <li>免費額度充足（15 RPM）</li>
                            <li>回應速度快</li>
                            <li>與 Google 服務整合佳</li>
                            <li>gemini-2.5-flash 效能優異</li>
                        </ul>
                        <h4>缺點</h4>
                        <ul>
                            <li>偶爾有內容過濾問題</li>
                            <li>中文評語偶有不自然處</li>
                        </ul>
                        <h4>適合對象</h4>
                        <p>預算有限、學生人數較少、測試階段</p>
                    </div>
                </div>

                <div class="example-box">
                    <h4>本課程建議</h4>
                    <p>初學者建議先使用 <strong>Gemini</strong> 測試系統，確認流程正確後再考慮切換到 OpenAI。兩種 API 的程式碼差異很小，切換非常容易。</p>
                </div>
            </div>
        </div>

        <!-- Slide 7: 需要準備的東西 -->
        <div class="slide">
            <div class="content-card">
                <h2>開始前的準備清單</h2>

                <div class="grid-2">
                    <div class="highlight-box">
                        <h4>帳號準備</h4>
                        <ul>
                            <li>□ Google 帳號（用於 GAS、Sheet）</li>
                            <li>□ LINE 帳號（用於建立 Bot）</li>
                            <li>□ LINE Developers 帳號</li>
                            <li>□ OpenAI 或 Google AI Studio 帳號</li>
                        </ul>
                    </div>
                    <div class="example-box">
                        <h4>API Key 準備</h4>
                        <ul>
                            <li>□ LINE Channel Access Token</li>
                            <li>□ LINE Channel Secret</li>
                            <li>□ OpenAI API Key <strong>或</strong></li>
                            <li>□ Google AI Studio API Key</li>
                        </ul>
                    </div>
                </div>

                <h3>申請連結</h3>
                <div class="grid-3">
                    <div class="card">
                        <h4>LINE Developers</h4>
                        <p style="word-break: break-all; font-size: 14px;">
                            https://developers.line.biz/
                        </p>
                        <p style="font-size: 13px; color: #666;">建立 Messaging API Channel</p>
                    </div>
                    <div class="card orange">
                        <h4>OpenAI Platform</h4>
                        <p style="word-break: break-all; font-size: 14px;">
                            https://platform.openai.com/
                        </p>
                        <p style="font-size: 13px; color: #666;">取得 API Key</p>
                    </div>
                    <div class="card blue">
                        <h4>Google AI Studio</h4>
                        <p style="word-break: break-all; font-size: 14px;">
                            https://aistudio.google.com/
                        </p>
                        <p style="font-size: 13px; color: #666;">取得 Gemini API Key</p>
                    </div>
                </div>

                <div class="highlight-box" style="margin-top: 25px;">
                    <h4>注意事項</h4>
                    <ul style="margin-bottom: 0;">
                        <li>LINE Developers 需使用與 LINE 帳號相同的 Email 登入</li>
                        <li>API Key 請妥善保管，不要公開分享</li>
                        <li>建議先在 AI Studio / Playground 測試 API 是否正常</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Slide 8: 小結 -->
        <div class="slide">
            <div class="content-card" style="text-align: center;">
                <h2>本單元小結</h2>

                <div class="grid-2" style="text-align: left; margin: 30px 0;">
                    <div class="highlight-box">
                        <h4>系統架構要點</h4>
                        <ol>
                            <li>LINE → GAS → Sheet → AI → LINE</li>
                            <li>完全免費的雲端架構</li>
                            <li>資料自動保存到 Sheet</li>
                            <li>可選擇 OpenAI 或 Gemini</li>
                        </ol>
                    </div>
                    <div class="example-box">
                        <h4>下一步行動</h4>
                        <ol>
                            <li>確認所有帳號已準備好</li>
                            <li>取得必要的 API Key</li>
                            <li>建立空白的 Google Sheet</li>
                            <li>準備進入實作！</li>
                        </ol>
                    </div>
                </div>

                <div style="background: linear-gradient(135deg, #e8f5e9, #c8e6c9); padding: 25px; border-radius: 15px;">
                    <p style="font-size: 20px; margin: 0; color: #00c300;">
                        <strong>下一單元預告</strong><br>
                        8-2 LINE Bot 建立與 Webhook 設定
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div class="progress-indicator"></div>

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;

        function createProgressDots() {
            const container = document.querySelector('.progress-indicator');
            for (let i = 0; i < totalSlides; i++) {
                const dot = document.createElement('div');
                dot.className = 'progress-dot' + (i === 0 ? ' active' : '');
                dot.onclick = () => goToSlide(i);
                container.appendChild(dot);
            }
        }

        function updateProgress() {
            document.querySelectorAll('.progress-dot').forEach((dot, i) => {
                dot.classList.toggle('active', i === currentSlide);
            });
        }

        function showSlide(index) {
            slides.forEach((slide, i) => {
                slide.classList.toggle('active', i === index);
            });
            updateProgress();
            document.querySelector('.prev-arrow').disabled = index === 0;
            document.querySelector('.next-arrow').disabled = index === totalSlides - 1;
        }

        function nextSlide() {
            if (currentSlide < totalSlides - 1) {
                currentSlide++;
                showSlide(currentSlide);
            }
        }

        function prevSlide() {
            if (currentSlide > 0) {
                currentSlide--;
                showSlide(currentSlide);
            }
        }

        function goToSlide(index) {
            currentSlide = index;
            showSlide(currentSlide);
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') nextSlide();
            if (e.key === 'ArrowLeft') prevSlide();
        });

        createProgressDots();
        showSlide(0);

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }
    </script>
</body>
</html>
