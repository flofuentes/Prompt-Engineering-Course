<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>9-1 四字評語生成設計 - 語音評語系統</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft JhengHei', 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #0c1445 0%, #1a237e 50%, #283593 100%);
            min-height: 100vh;
            overflow: hidden;
            color: #333;
        }
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-image:
                radial-gradient(2px 2px at 20px 30px, white, transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
                radial-gradient(1px 1px at 90px 40px, white, transparent);
            background-size: 550px 250px;
            animation: twinkle 8s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }
        @keyframes twinkle {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 0.4; }
        }

        .nav-bar {
            position: fixed;
            top: 0; left: 0; right: 0;
            height: 60px;
            background: rgba(26, 35, 126, 0.95);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.15);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 30px;
            z-index: 10000;
        }
        .nav-title {
            font-size: 20px;
            font-weight: 700;
            background: linear-gradient(90deg, #0277bd, #039be5);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .nav-buttons { display: flex; gap: 12px; }
        .nav-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 18px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        .nav-btn:hover {
            background: rgba(2, 119, 189, 0.3);
            border-color: #0277bd;
        }

        .nav-arrow {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(26, 35, 126, 0.8);
            color: white;
            width: 60px; height: 60px;
            border-radius: 50%;
            border: 2px solid rgba(2, 119, 189, 0.5);
            font-size: 24px;
            cursor: pointer;
            z-index: 9000;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .nav-arrow:hover {
            background: rgba(57, 73, 171, 0.9);
            transform: translateY(-50%) scale(1.1);
        }
        .prev-arrow { left: 30px; }
        .next-arrow { right: 30px; }
        .nav-arrow:disabled { opacity: 0.3; cursor: not-allowed; }

        .slide-container {
            width: 100%;
            height: 100vh;
            padding-top: 60px;
            position: relative;
            z-index: 1;
        }
        .slide {
            position: absolute;
            top: 60px; left: 0;
            width: 100%;
            height: calc(100vh - 60px);
            display: none;
            align-items: center;
            justify-content: center;
            padding: 40px;
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: 10;
        }
        .slide.active {
            display: flex;
            opacity: 1;
            z-index: 20;
        }

        .content-card {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            padding: 35px 45px;
            max-width: 1400px;
            width: 96%;
            max-height: 88vh;
            overflow-y: auto;
            position: relative;
        }

        h1 {
            font-size: 38px;
            margin-bottom: 15px;
            text-align: center;
            background: linear-gradient(135deg, #0277bd, #039be5);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        h2 {
            color: #0277bd;
            font-size: 28px;
            margin-bottom: 20px;
            border-bottom: 4px solid;
            border-image: linear-gradient(90deg, #0277bd, #039be5) 1;
            padding-bottom: 10px;
        }
        h3 { color: #01579b; font-size: 20px; margin: 18px 0 10px 0; }
        h4 { color: #0277bd; font-size: 17px; margin: 12px 0 8px 0; }

        p, li {
            font-size: 16px;
            line-height: 1.7;
            color: #444;
            margin-bottom: 8px;
        }
        ul, ol { margin-left: 25px; margin-bottom: 12px; }

        .prompt-box {
            background: linear-gradient(135deg, #fff3e0, #ffe0b2);
            border: 3px solid #ff6f00;
            padding: 20px;
            border-radius: 15px;
            margin: 15px 0;
            position: relative;
        }
        .prompt-box::before {
            content: 'AI 提示詞';
            position: absolute;
            top: -12px;
            left: 20px;
            background: #ff6f00;
            color: white;
            padding: 4px 15px;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 700;
        }
        .prompt-box pre {
            background: #fff;
            padding: 15px;
            border-radius: 10px;
            font-family: 'Consolas', monospace;
            font-size: 14px;
            line-height: 1.5;
            white-space: pre-wrap;
            margin: 10px 0 0 0;
            border: 1px solid #ffcc80;
        }

        .code-box {
            background: linear-gradient(135deg, #1a237e, #283593);
            color: #e8eaf6;
            padding: 20px;
            border-radius: 12px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            line-height: 1.5;
            margin: 15px 0;
            overflow-x: auto;
            position: relative;
        }
        .code-box::before {
            content: 'GAS 程式碼';
            position: absolute;
            top: -12px;
            left: 20px;
            background: #0277bd;
            color: white;
            padding: 4px 15px;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 700;
        }
        .code-box .comment { color: #81c784; }
        .code-box .keyword { color: #64b5f6; }
        .code-box .string { color: #ffb74d; }
        .code-box .function { color: #ce93d8; }

        .highlight-box {
            background: linear-gradient(135deg, #e1f5fe, #b3e5fc);
            border-left: 5px solid #0277bd;
            padding: 18px 22px;
            border-radius: 0 15px 15px 0;
            margin: 15px 0;
        }
        .highlight-box h4 { color: #0277bd; margin-top: 0; }

        .example-box {
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            border-left: 5px solid #4caf50;
            padding: 18px 22px;
            border-radius: 0 15px 15px 0;
            margin: 15px 0;
        }
        .example-box h4 { color: #2e7d32; margin-top: 0; }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 15px 0;
        }
        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 15px 0;
        }

        .card {
            background: #f5f5f5;
            border-radius: 15px;
            padding: 20px;
            border-top: 4px solid #0277bd;
        }
        .card.orange { border-top-color: #ff6f00; }
        .card.green { border-top-color: #4caf50; }
        .card h4 { margin-top: 0; }

        .evaluation-card {
            background: linear-gradient(135deg, #fce4ec, #f8bbd9);
            border: 2px solid #c2185b;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            margin: 15px 0;
        }
        .evaluation-card .four-char {
            font-size: 32px;
            font-weight: 800;
            color: #880e4f;
            margin-bottom: 15px;
            letter-spacing: 4px;
        }
        .evaluation-card .feedback {
            font-size: 16px;
            color: #4a148c;
            line-height: 1.8;
        }

        .tag {
            display: inline-block;
            background: #0277bd;
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 12px;
            margin-right: 8px;
            margin-bottom: 8px;
        }
        .tag.orange { background: #ff6f00; }
        .tag.green { background: #4caf50; }
        .tag.red { background: #d32f2f; }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 5px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }
        .copy-btn:hover { background: rgba(255,255,255,0.3); }

        .progress-indicator {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            z-index: 9999;
        }
        .progress-dot {
            width: 12px; height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s;
        }
        .progress-dot.active {
            background: #0277bd;
            transform: scale(1.3);
        }

        @media (max-width: 900px) {
            .grid-2, .grid-3 { grid-template-columns: 1fr; }
            .content-card { padding: 20px; }
            h1 { font-size: 28px; }
            h2 { font-size: 22px; }
        }
    </style>
</head>
<body>
    <nav class="nav-bar">
        <div class="nav-title">9-1 四字評語生成設計</div>
        <div class="nav-buttons">
            <a href="index2.html" class="nav-btn">首頁</a>
            <a href="Part9-2_文字敘述評語.html" class="nav-btn">下一章</a>
            <button class="nav-btn" onclick="toggleFullscreen()">全螢幕</button>
            <a href="https://www.youtube.com/@Liang-yt02" target="_blank" class="nav-btn">YT</a>
            <a href="https://www.facebook.com/?locale=zh_TW" target="_blank" class="nav-btn">FB</a>
            <a href="https://www.facebook.com/groups/2754139931432955?locale=zh_TW" target="_blank" class="nav-btn">3A</a>
        </div>
    </nav>

    <button class="nav-arrow prev-arrow" onclick="prevSlide()">←</button>
    <button class="nav-arrow next-arrow" onclick="nextSlide()">→</button>

    <div class="slide-container">
        <!-- Slide 1: 標題頁 -->
        <div class="slide active">
            <div class="content-card" style="text-align: center;">
                <div style="margin-bottom: 25px;">
                    <span class="tag">Part 9-1</span>
                    <span class="tag orange">語音評語系統</span>
                    <span class="tag red">實作</span>
                </div>
                <h1>四字評語生成設計</h1>
                <p style="font-size: 20px; color: #0277bd; margin: 25px 0;">
                    「學海無涯・勤能補拙」風格的精簡評語
                </p>

                <div class="evaluation-card" style="max-width: 600px; margin: 30px auto;">
                    <div class="four-char">探索未知・勇於嘗試</div>
                    <div class="feedback">你的火星探測報告展現了對科學探究的熱情，特別是在能源方案的分析上很有見地。建議可以再補充一些數據佐證。</div>
                </div>

                <p style="font-size: 16px; color: #666;">
                    讓 AI 生成有溫度、有深度的四字評語
                </p>
            </div>
        </div>

        <!-- Slide 2: 四字評語的設計原則 -->
        <div class="slide">
            <div class="content-card">
                <h2>四字評語的設計原則</h2>

                <div class="grid-3">
                    <div class="card">
                        <h4>1. 正向鼓勵</h4>
                        <p>以肯定學生優點為主</p>
                        <ul>
                            <li>勤學好問</li>
                            <li>精益求精</li>
                            <li>腳踏實地</li>
                            <li>志向高遠</li>
                        </ul>
                    </div>
                    <div class="card orange">
                        <h4>2. 呼應主題</h4>
                        <p>與作品內容相關聯</p>
                        <ul>
                            <li>探索未知（太空主題）</li>
                            <li>深海奧秘（海洋主題）</li>
                            <li>科學精神（實驗報告）</li>
                            <li>創意無限（設計作品）</li>
                        </ul>
                    </div>
                    <div class="card green">
                        <h4>3. 前後呼應</h4>
                        <p>四字+四字形成完整意涵</p>
                        <ul>
                            <li>學海無涯・勤能補拙</li>
                            <li>博觀約取・厚積薄發</li>
                            <li>千里之行・始於足下</li>
                            <li>精雕細琢・匠心獨具</li>
                        </ul>
                    </div>
                </div>

                <div class="highlight-box">
                    <h4>評語格式</h4>
                    <p style="font-size: 20px; text-align: center; margin: 10px 0;">
                        <strong>○○○○ ・ ○○○○</strong>
                    </p>
                    <p style="margin-bottom: 0; text-align: center;">前四字描述學生特質 + 後四字給予期許或肯定</p>
                </div>
            </div>
        </div>

        <!-- Slide 3: 四字評語庫 -->
        <div class="slide">
            <div class="content-card">
                <h2>四字評語庫（給 AI 參考）</h2>

                <div class="grid-2">
                    <div class="example-box">
                        <h4>學習態度類</h4>
                        <ul style="margin-bottom: 0;">
                            <li><strong>勤學好問・求知若渴</strong> - 對學習充滿熱情</li>
                            <li><strong>腳踏實地・穩步前行</strong> - 踏實認真的學生</li>
                            <li><strong>精益求精・追求卓越</strong> - 不斷進步的學生</li>
                            <li><strong>虛心學習・日新月異</strong> - 謙虛且進步快</li>
                            <li><strong>持之以恆・水滴石穿</strong> - 有毅力的學生</li>
                        </ul>
                    </div>
                    <div class="example-box">
                        <h4>思考能力類</h4>
                        <ul style="margin-bottom: 0;">
                            <li><strong>獨立思考・見解獨到</strong> - 有自己想法</li>
                            <li><strong>舉一反三・觸類旁通</strong> - 理解力強</li>
                            <li><strong>條理分明・邏輯清晰</strong> - 組織能力好</li>
                            <li><strong>深入淺出・融會貫通</strong> - 理解透徹</li>
                            <li><strong>推陳出新・別出心裁</strong> - 有創意</li>
                        </ul>
                    </div>
                    <div class="highlight-box">
                        <h4>太空海洋主題類</h4>
                        <ul style="margin-bottom: 0;">
                            <li><strong>探索未知・勇往直前</strong> - 對太空探索有熱情</li>
                            <li><strong>仰望星空・腳踏實地</strong> - 有夢想且務實</li>
                            <li><strong>深海奧秘・求知若渴</strong> - 對海洋研究有興趣</li>
                            <li><strong>乘風破浪・勇往直前</strong> - 面對挑戰不畏懼</li>
                        </ul>
                    </div>
                    <div class="card">
                        <h4>表達能力類</h4>
                        <ul style="margin-bottom: 0;">
                            <li><strong>文筆流暢・表達清晰</strong></li>
                            <li><strong>言之有物・論述有據</strong></li>
                            <li><strong>圖文並茂・呈現完整</strong></li>
                            <li><strong>深入淺出・淺顯易懂</strong></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 4: AI 提示詞設計 -->
        <div class="slide">
            <div class="content-card">
                <h2>AI 提示詞設計：生成四字評語</h2>

                <div class="prompt-box">
                    <p style="margin: 0 0 10px 0;"><strong>複製這段提示詞：</strong></p>
                    <pre>你是一位擅長文字的國文老師，請根據學生作品生成「四字+四字」格式的評語。

【評語格式】○○○○・○○○○
- 前四字：描述學生展現的優點或特質
- 後四字：給予肯定或期許
- 中間用「・」（間隔號）連接

【風格要求】
1. 正向鼓勵，避免負面用詞
2. 與作品主題相關
3. 使用常見成語或四字詞語
4. 適合[國小/國中/高中]學生理解

【學生作品】
{content}

【輸出】
只輸出一行四字評語，格式為：○○○○・○○○○</pre>
                </div>

                <div class="grid-2">
                    <div class="example-box">
                        <h4>輸入範例（學生作品）</h4>
                        <p style="margin-bottom: 0; font-size: 14px;">
                            「我研究了火星探測車的能源系統，發現核能電池比太陽能更適合火星環境。因為火星常有沙塵暴，會影響太陽能板的效率...」
                        </p>
                    </div>
                    <div class="highlight-box">
                        <h4>AI 輸出範例</h4>
                        <p style="margin-bottom: 0; font-size: 20px; text-align: center;">
                            <strong>探索未知・分析入微</strong>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 5: 完整評語生成函數 -->
        <div class="slide">
            <div class="content-card">
                <h2>完整評語生成函數（含四字評語）</h2>

                <div class="code-box">
                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
<span class="comment">// ===== 生成完整評語（四字+文字說明）=====</span>
<span class="keyword">function</span> <span class="function">generateFullFeedback</span>(content) {
  <span class="keyword">const</span> url = <span class="string">`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${GEMINI_API_KEY}`</span>;

  <span class="keyword">const</span> prompt = <span class="string">`你是一位專業且溫暖的教師，請針對學生作品給予評語。

【學生作品】
${content}

【評語要求】
1. 四字評語：用「○○○○・○○○○」格式，正向鼓勵
2. 文字回饋：50-100字，包含肯定與建議

【參考四字詞庫】
- 勤學好問、精益求精、腳踏實地、探索未知
- 條理分明、邏輯清晰、深入淺出、見解獨到
- 仰望星空、深海奧秘、乘風破浪、求知若渴

【輸出格式】（請嚴格遵守）
四字評語：○○○○・○○○○
文字回饋：（50-100字）`</span>;

  <span class="keyword">const</span> payload = {
    contents: [{ parts: [{ text: prompt }] }],
    generationConfig: { temperature: 0.8, maxOutputTokens: 300 }
  };

  <span class="keyword">const</span> options = {
    method: <span class="string">'post'</span>,
    contentType: <span class="string">'application/json'</span>,
    payload: <span class="function">JSON.stringify</span>(payload),
    muteHttpExceptions: <span class="keyword">true</span>
  };

  <span class="keyword">try</span> {
    <span class="keyword">const</span> response = <span class="function">UrlFetchApp.fetch</span>(url, options);
    <span class="keyword">const</span> result = <span class="function">JSON.parse</span>(response.<span class="function">getContentText</span>());
    <span class="keyword">return</span> result.candidates[0].content.parts[0].text;
  } <span class="keyword">catch</span> (error) {
    <span class="keyword">return</span> <span class="string">'四字評語：勤學好問・繼續加油\n文字回饋：感謝你的用心，老師會仔細閱讀。'</span>;
  }
}
                </div>
            </div>
        </div>

        <!-- Slide 6: 解析評語函數 -->
        <div class="slide">
            <div class="content-card">
                <h2>解析評語函數（分離四字與文字）</h2>

                <div class="code-box">
                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
<span class="comment">// ===== 解析 AI 回傳的評語 =====</span>
<span class="keyword">function</span> <span class="function">parseFeedback</span>(aiResponse) {
  <span class="keyword">const</span> result = {
    fourChar: <span class="string">''</span>,    <span class="comment">// 四字評語</span>
    feedback: <span class="string">''</span>     <span class="comment">// 文字回饋</span>
  };

  <span class="comment">// 使用正則表達式提取</span>
  <span class="keyword">const</span> fourCharMatch = aiResponse.<span class="function">match</span>(<span class="string">/四字評語[：:]\s*(.+)/</span>);
  <span class="keyword">const</span> feedbackMatch = aiResponse.<span class="function">match</span>(<span class="string">/文字回饋[：:]\s*([\s\S]+)/</span>);

  <span class="keyword">if</span> (fourCharMatch) {
    result.fourChar = fourCharMatch[1].<span class="function">trim</span>();
  }

  <span class="keyword">if</span> (feedbackMatch) {
    result.feedback = feedbackMatch[1].<span class="function">trim</span>();
  }

  <span class="keyword">return</span> result;
}

<span class="comment">// ===== 格式化輸出給 LINE =====</span>
<span class="keyword">function</span> <span class="function">formatLineMessage</span>(parsed) {
  <span class="keyword">return</span> <span class="string">`
【四字評語】
${parsed.fourChar}

【老師回饋】
${parsed.feedback}
`</span>.<span class="function">trim</span>();
}

<span class="comment">// ===== 測試解析函數 =====</span>
<span class="keyword">function</span> <span class="function">testParseFeedback</span>() {
  <span class="keyword">const</span> mockResponse = <span class="string">`四字評語：探索未知・勇於嘗試
文字回饋：你的報告展現了對火星探測的深入理解，特別是能源方案的分析很有見地。建議可以再補充一些實際數據來支持你的論點。`</span>;

  <span class="keyword">const</span> parsed = <span class="function">parseFeedback</span>(mockResponse);
  <span class="keyword">const</span> formatted = <span class="function">formatLineMessage</span>(parsed);

  <span class="function">console.log</span>(<span class="string">'解析結果：'</span>, parsed);
  <span class="function">console.log</span>(<span class="string">'格式化訊息：'</span>, formatted);
}
                </div>
            </div>
        </div>

        <!-- Slide 7: 儲存到 Sheet 並回覆 -->
        <div class="slide">
            <div class="content-card">
                <h2>整合：儲存評語到 Sheet 並回覆 LINE</h2>

                <div class="code-box">
                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
<span class="comment">// ===== 完整處理流程 =====</span>
<span class="keyword">function</span> <span class="function">handleMessageComplete</span>(event) {
  <span class="keyword">const</span> userId = event.source.userId;
  <span class="keyword">const</span> replyToken = event.replyToken;
  <span class="keyword">const</span> content = event.message.text;

  <span class="comment">// 1. 呼叫 AI 生成評語</span>
  <span class="keyword">const</span> aiResponse = <span class="function">generateFullFeedback</span>(content);

  <span class="comment">// 2. 解析評語</span>
  <span class="keyword">const</span> parsed = <span class="function">parseFeedback</span>(aiResponse);

  <span class="comment">// 3. 儲存到 Google Sheet（含四字評語欄位）</span>
  <span class="function">saveToSheetWithFeedback</span>(userId, content, parsed.fourChar, parsed.feedback);

  <span class="comment">// 4. 格式化並回覆 LINE</span>
  <span class="keyword">const</span> message = <span class="function">formatLineMessage</span>(parsed);
  <span class="function">replyMessage</span>(replyToken, message);
}

<span class="comment">// ===== 儲存含評語的資料到 Sheet =====</span>
<span class="keyword">function</span> <span class="function">saveToSheetWithFeedback</span>(userId, content, fourChar, feedback) {
  <span class="keyword">const</span> ss = SpreadsheetApp.<span class="function">openById</span>(SPREADSHEET_ID);
  <span class="keyword">const</span> sheet = ss.<span class="function">getSheetByName</span>(SHEET_NAME);

  sheet.<span class="function">appendRow</span>([
    <span class="keyword">new</span> <span class="function">Date</span>(),              <span class="comment">// A: 時間</span>
    userId,                     <span class="comment">// B: LINE ID</span>
    content.<span class="function">substring</span>(0, 500), <span class="comment">// C: 作品內容</span>
    fourChar,                   <span class="comment">// D: 四字評語</span>
    feedback                    <span class="comment">// E: 文字回饋</span>
  ]);
}
                </div>

                <div class="highlight-box">
                    <h4>Sheet 欄位結構</h4>
                    <p style="margin-bottom: 0;">A: 時間 | B: LINE ID | C: 作品內容 | D: 四字評語 | E: 文字回饋</p>
                </div>
            </div>
        </div>

        <!-- Slide 8: 實作練習 -->
        <div class="slide">
            <div class="content-card">
                <h2>實作練習：自訂四字評語風格</h2>

                <div class="prompt-box">
                    <p style="margin: 0 0 10px 0;"><strong>練習：修改提示詞，加入你的教學風格</strong></p>
                    <pre>【練習任務】
1. 在提示詞中加入 5-10 個你喜歡的四字成語
2. 指定評語的語氣（溫暖、幽默、嚴謹...）
3. 針對特定科目調整詞彙（數學、自然、國文...）

【範例：數學科評語詞庫】
- 舉一反三、觸類旁通、融會貫通
- 精確計算、條理分明、思路清晰
- 化繁為簡、循序漸進、厚積薄發

【範例：國文科評語詞庫】
- 文采飛揚、妙筆生花、言之有物
- 見解獨到、深入淺出、旁徵博引
- 出口成章、字字珠璣、文思泉湧</pre>
                </div>

                <div class="grid-2">
                    <div class="example-box">
                        <h4>自我檢核</h4>
                        <ul style="margin-bottom: 0;">
                            <li>□ 提示詞是否明確指定輸出格式？</li>
                            <li>□ 是否提供足夠的詞彙參考？</li>
                            <li>□ 測試後評語是否符合預期？</li>
                        </ul>
                    </div>
                    <div class="highlight-box">
                        <h4>進階挑戰</h4>
                        <p style="margin-bottom: 0;">試著讓 AI 根據作品分數等級（優/良/可/待加強）生成不同風格的四字評語！</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 9: 小結 -->
        <div class="slide">
            <div class="content-card" style="text-align: center;">
                <h2>本單元小結</h2>

                <div class="evaluation-card" style="max-width: 700px; margin: 25px auto;">
                    <div class="four-char">學以致用・融會貫通</div>
                    <div class="feedback">
                        你已經學會如何設計 AI 提示詞來生成四字評語，
                        並能整合到 LINE 機器人系統中。
                        下一步將學習如何把評語轉換成語音！
                    </div>
                </div>

                <div class="grid-2" style="text-align: left; max-width: 800px; margin: 25px auto;">
                    <div class="highlight-box">
                        <h4>本單元重點</h4>
                        <ol style="margin-bottom: 0;">
                            <li>四字評語格式：○○○○・○○○○</li>
                            <li>提示詞設計：提供詞彙庫</li>
                            <li>解析函數：分離四字與文字</li>
                            <li>整合儲存：記錄到 Sheet</li>
                        </ol>
                    </div>
                    <div class="card">
                        <h4>下一單元預告</h4>
                        <p style="margin-bottom: 0;">
                            <strong>9-2 文字敘述評語設計</strong><br>
                            如何讓 AI 生成有深度的 50-100 字回饋
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="progress-indicator"></div>

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;

        function createProgressDots() {
            const container = document.querySelector('.progress-indicator');
            for (let i = 0; i < totalSlides; i++) {
                const dot = document.createElement('div');
                dot.className = 'progress-dot' + (i === 0 ? ' active' : '');
                dot.onclick = () => goToSlide(i);
                container.appendChild(dot);
            }
        }

        function updateProgress() {
            document.querySelectorAll('.progress-dot').forEach((dot, i) => {
                dot.classList.toggle('active', i === currentSlide);
            });
        }

        function showSlide(index) {
            slides.forEach((slide, i) => {
                slide.classList.toggle('active', i === index);
            });
            updateProgress();
            document.querySelector('.prev-arrow').disabled = index === 0;
            document.querySelector('.next-arrow').disabled = index === totalSlides - 1;
        }

        function nextSlide() {
            if (currentSlide < totalSlides - 1) {
                currentSlide++;
                showSlide(currentSlide);
            }
        }

        function prevSlide() {
            if (currentSlide > 0) {
                currentSlide--;
                showSlide(currentSlide);
            }
        }

        function goToSlide(index) {
            currentSlide = index;
            showSlide(currentSlide);
        }

        function copyCode(btn) {
            const codeBox = btn.parentElement;
            const code = codeBox.innerText.replace('複製', '').trim();
            navigator.clipboard.writeText(code);
            btn.textContent = '已複製!';
            setTimeout(() => btn.textContent = '複製', 2000);
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') nextSlide();
            if (e.key === 'ArrowLeft') prevSlide();
        });

        createProgressDots();
        showSlide(0);

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }
    </script>
</body>
</html>
